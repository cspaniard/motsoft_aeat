<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <!-- ====================================================================================================  -->
    <record id="motsoft_aeat.l10n_es_aeat_mod111_report" model="ir.actions.report">
        <field name="name">Datos Asesoría</field>
        <field name="model">l10n.es.aeat.mod111.report</field>
        <field name="report_type">qweb-html</field>
        <field name="report_name">motsoft_aeat.tax_line_111_report</field>
        <field name="print_report_name">'%s-Mod_111_%s-%s' % (object.company_id.name, object.period_type, object.year)</field>
        <field name="attachment_use">False</field>
        <field name="binding_model_id" ref="model_l10n_es_aeat_mod111_report"/>
        <field name="binding_type">report</field>
    </record>

    <record id="motsoft_aeat.l10n_es_aeat_mod115_report" model="ir.actions.report">
        <field name="name">Datos Asesoría</field>
        <field name="model">l10n.es.aeat.mod115.report</field>
        <field name="report_type">qweb-html</field>
        <field name="report_name">motsoft_aeat.tax_line_115_report</field>
        <field name="print_report_name">'%s-Mod_115_%s-%s' % (object.company_id.name, object.period_type, object.year)</field>
        <field name="attachment_use">False</field>
        <field name="binding_model_id" ref="model_l10n_es_aeat_mod115_report"/>
        <field name="binding_type">report</field>
    </record>

    <record id="motsoft_aeat.l10n_es_aeat_mod303_report" model="ir.actions.report">
        <field name="name">Datos Asesoría 303</field>
        <field name="model">l10n.es.aeat.mod303.report</field>
        <field name="report_type">qweb-html</field>
        <field name="report_name">motsoft_aeat.tax_line_303_report</field>
        <field name="print_report_name">'%s-Mod_303_%s-%s' % (object.company_id.name, object.period_type, object.year)</field>
        <field name="attachment_use">False</field>
        <field name="binding_model_id" ref="model_l10n_es_aeat_mod303_report"/>
        <field name="binding_type">report</field>
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <template id="motsoft_aeat.tax_line_report">
        <t t-foreach="docs" t-as="this_model">
            <t t-call="web.html_container">
                <t t-call="web.external_layout">
                    <table style="width: 100%; margin-bottom: 0px; margin-top: 10px;" class="table table-sm o_main_table">
                        <thead>
                            <tr>
                                <th class="text-start">
                                    <h4 style="margin-bottom: 0px;">
                                        <span>MODELO</span> <span t-field="this_model.number"/>
                                    </h4>
                                </th>
                                <th class="text-end">
                                    <h4 style="margin-bottom: 0px;">
                                        <span t-field="this_model.period_type"/> - <span t-field="this_model.year"/>
                                    </h4>
                                </th>
                            </tr>
                        </thead>
                        <tbody> <tr> <td/> <td/> </tr> </tbody>
                    </table>

                    <t t-raw="0"/>

                    <div class="page" style="margin-top: 30px;">
                        <table style="width: 100%;" class="table table-sm o_main_table">
                            <thead>
                                <tr>
                                    <th class="text-end" style="width: 80px !important;"><span>Casilla</span></th>
                                    <th class="text-start"><span>Nombre</span></th>
                                    <th class="text-end"><span>Importe</span></th>
                                </tr>
                            </thead>

                            <tbody class="invoice_tbody">
                                <t t-foreach="this_model.tax_line_ids" t-as="o">
                                    <tr t-if="o.amount">
                                        <td class="text-end"><span t-field="o.field_number"/></td>
                                        <td class="text-start"><span t-field="o.name"/></td>
                                        <td class="text-end"><span t-field="o.amount"/></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </t>
          </t>
      </t>
    </template>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <template id="motsoft_aeat.tax_line_111_report">
        <t t-foreach="docs" t-as="this_model">
            <t t-call="motsoft_aeat.tax_line_report">
                <table t-if="len(this_model.partners_info_8_9)" style="margin-top: 30px; width: 100%" class="table table-sm o_main_table">
                    <thead>
                        <tr>
                            <th style="text-align: left;">Actividades Económicas (dinerarios)</th>
                            <th style="text-align: right;">CIF/NIF</th>
                            <th style="text-align: right;">Base</th>
                            <th style="text-align: right;">Retención</th>
                        </tr>
                    </thead>
                        <t t-foreach="this_model.partners_info_8_9.ids" t-as="pi">
                            <t t-call="motsoft_aeat.tax_line_report"/>
                        </t>
                </table>
            </t>
        </t>
    </template>

    <template id="motsoft_aeat.tax_partner_list">
        <tr>
            <td><span t-esc="pi['name']" /></td>
            <td class="text-end"><span t-esc="pi['vat']"/></td>
            <td class="text-end"><span t-esc="pi['base_amount']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></td>
            <td class="text-end"><span t-esc="pi['tax_amount']" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/></td>
        </tr>
    </template>

    <template id="motsoft_aeat.tax_line_115_report">
        <t t-foreach="docs" t-as="this_model">
            <t t-call="motsoft_aeat.tax_line_report">
                <table style="margin-top: 20px; width: 100%">
                    <tbody class="invoice_tbody">
                        <tr>
                            <td>[01] Nº de perceptores:</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_01" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>

                            <td>[04] Resultados anteriores a compensar:</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_04" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                        </tr>
                        <tr><td colspan="8" style="width: 100%; height: 10px"/></tr>
                        <tr>
                            <td>[03] Retenciones e ingresos a cuenta:</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_03" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>

                            <td>[05] Resultado a ingresar:</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_05" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="8" class="text-end">
                                <div> </div>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <table t-if="len(this_model.partners_info_2_3)" style="margin-top: 30px; width: 100%" class="table table-sm o_main_table">
                    <thead>
                        <tr>
                            <th style="text-align: left;">Perceptor</th>
                            <th style="text-align: right;">CIF/NIF</th>
                            <th style="text-align: right;">Base</th>
                            <th style="text-align: right;">Retención</th>
                        </tr>
                    </thead>
                    <t t-foreach="this_model.partners_info_2_3.ids" t-as="pi">
                        <t t-call="motsoft_aeat.tax_line_report"/>
                    </t>
                </table>
            </t>
        </t>
    </template>

    <template id="motsoft_aeat.tax_line_303_report">
        <t t-foreach="docs" t-as="this_model">
            <t t-call="motsoft_aeat.tax_line_report">
                <table style="margin-top: 20px; width: 100%">
                    <tbody class="invoice_tbody">
                        <tr>
                            <td>[27] IVA Devengado:</td>
                            <td class="text-end">
                                <span t-field="this_model.total_devengado" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>

                            <td>[65] % Atribuible al Estado:</td>
                            <td class="text-end">
                                <span t-field="this_model.porcentaje_atribuible_estado" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>

                            <td>[68] Reg. Anual:</td>
                            <td class="text-end">
                                <span t-field="this_model.regularizacion_anual" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                        </tr>
                        <tr><td colspan="8" style="width: 100%; height: 10px"/></tr>
                        <tr>
                            <td>[45] IVA a Deducir:</td>
                            <td class="text-end">
                                <span t-field="this_model.total_deducir" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>

                            <td>[66] Atribuible a la Administración:</td>
                            <td class="text-end">
                                <span t-field="this_model.atribuible_estado" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>
                            
                            <td>[77] IVA Diferido (aduana):</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_77" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                        </tr>
                        <tr><td colspan="8" style="width: 100%; height: 10px"/></tr>
                        <tr>
                            <td>[46] Resultado Régimen General:</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_46" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>
                            
                            <td>[67] Cuotas a compensar:</td>
                            <td class="text-end">
                                <span t-field="this_model.cuota_compensar" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                            <td style="width: 10%"/>
                            
                            <td>[69] Resultado:</td>
                            <td class="text-end">
                                <span t-field="this_model.casilla_69" t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                            </td>
                        </tr>
                        <tr><td colspan="8" style="width: 100%; height: 10px"/></tr>
                        <tr>
                            <td colspan="8" class="text-end" style="padding-right: 0px;">
                                <table style="float: right; font-weight: bold">
                                    <tr>
                                        <td style="width: 500px;">
                                            <span>[71] Resultado liquidación:</span>
                                        </td>
                                        <td style="width: 110px">
                                            <span t-field="this_model.resultado_liquidacion" 
                                                  t-options="{'widget': 'monetary', 'display_currency': res_company.currency_id}"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="width: 500px; border-bottom: 0px solid;">
                                            <span>Tipo de Resultado:</span>
                                        </td>
                                        <td style="width: 110px; border-bottom: 0px solid;">
                                            <span t-field="this_model.result_type"/>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="8" class="text-end">
                                <div> </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </t>
        </t>
    </template>

    <template id="motsoft_aeat.tax_line_390_report">
        <t t-call="motsoft_aeat.tax_line_report">
        </t>
    </template>
    <!-- ====================================================================================================  -->

</odoo>
