<?xml version="1.0" encoding="UTF-8"?>

<odoo>

    <!-- ====================================================================================================  -->
    <!-- Líneas de Impuestos -->
    <!-- ====================================================================================================  -->
    <record model="ir.ui.view" id="motsoft_aeat.view_l10n_es_aeat_tax_line_tree">
        <field name="name">motsoft_aeat_view_l10n_es_aeat_tax_line_tree</field>
        <field name="model">l10n.es.aeat.tax.line</field>
        <field name="inherit_id" ref="l10n_es_aeat.view_l10n_es_aeat_tax_line_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="attributes">
                <attribute name="limit">1000</attribute>
                <attribute name="create">false</attribute>
                <attribute name="delete">false</attribute>
                <attribute name="editable"/>
            </xpath>
        </field>
    </record>

    <!-- ====================================================================================================  -->
    <record model="ir.ui.view" id="motsoft_aeat.tax_line_search">
        <field name="name">motsoft_aeat_tax_line_search</field>
        <field name="model">l10n.es.aeat.tax.line</field>
        <field name="arch" type="xml">
            <search>
                <filter name="not_0" domain="[('amount','!=',0)]" string="Con Saldo"/>
            </search>
        </field>
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <!-- Vista genérica para todos los modelos. -->
    <!-- ====================================================================================================  -->
    <record model="ir.actions.act_window" id="motsoft_aeat.aeat_report_action">
        <field name="name">Líneas de Impuestos</field>
        <field name="res_model">l10n.es.aeat.tax.line</field>
        <field name="search_view_id" ref="motsoft_aeat.tax_line_search"/>
        <field name="context">{'search_default_not_0': 1}</field>
        <!-- field name="domain">[('model', '=', 'l10n.es.aeat.mod303.report')]</field -->
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <!-- Vista tipo search genérica para todos los modelos AEAT  -->
    <!-- ====================================================================================================  -->
    <record id="motsoft_aeat.view_l10n_es_aeat_report_search" model="ir.ui.view">
        <field name="name">motsoft_aeat_view_l10n_es_aeat_report_search</field>
        <field name="model">l10n.es.aeat.report</field>
        <field name="arch" type="xml">
            <search string="AEAT Report Search">
                <field name="year"/>
                <filter string="Fecha Inicio Periodo" name="mot_date_start" date="date_start"/>
                <filter string="Fecha Final Periodo" name="mot_date_end" date="date_end"/>
                <separator/>
                <filter string="Este Año" name="mot_current_year"
                        domain='["&amp;", ("date_start", "&gt;=", (context_today() + relativedelta(month = 1, day = 1)).strftime("%Y-%m-%d")), ("date_start", "&lt;", (context_today() + relativedelta(month = 1, day = 1, years = 1)).strftime("%Y-%m-%d"))]'/>
                <group expand="0" string="Group By">
                    <filter string="Año" name="mod_year" context="{'group_by':'year'}"/>
                </group>
            </search>
        </field>
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <!-- Asigna la vista tipo search a cada una de las acciones que abren los modelos AEAT -->
    <!-- ====================================================================================================  -->
    <record id="l10n_es_aeat_mod111.action_l10n_es_aeat_mod111_report" model="ir.actions.act_window">
        <field name="search_view_id" ref="motsoft_aeat.view_l10n_es_aeat_report_search"/>
        <field name="context">{'search_default_mot_current_year': 1}</field>
    </record>

    <record id="l10n_es_aeat_mod115.action_l10n_es_aeat_mod115_report" model="ir.actions.act_window">
        <field name="search_view_id" ref="motsoft_aeat.view_l10n_es_aeat_report_search"/>
        <field name="context">{'search_default_mot_current_year': 1}</field>
    </record>

    <record id="l10n_es_aeat_mod303.action_l10n_es_aeat_mod303_report" model="ir.actions.act_window">
        <field name="search_view_id" ref="motsoft_aeat.view_l10n_es_aeat_report_search"/>
        <field name="context">{'search_default_mot_current_year': 1}</field>
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <!-- Modelo 111 - Formulario -->
    <!-- ====================================================================================================  -->
    <record id="motsoft_aeat.mod111_form" model="ir.ui.view">
        <field name="name">motsoft_aeat.mod111_form</field>
        <field name="model">l10n.es.aeat.mod111.report</field>
        <field name="inherit_id" ref="l10n_es_aeat_mod111.view_l10n_es_aeat_mod111_report_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='tax_line_ids']" position="before">
                <group colspan="2">
                    <div class="oe_button_box" style="text-align: left; margin-top: 0.1em">
                        <button type="object" name="show_tax_lines" class="oe_stat_button"
                                icon="fa-list" string="Analizar Líneas" groups="base.group_user"/>
                    </div>
                </group>
            </xpath>
        </field>
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <!-- Modelo 115 - Formulario -->
    <!-- ====================================================================================================  -->
    <record id="motsoft_aeat.mod115_form" model="ir.ui.view">
        <field name="name">motsoft_aeat.mod115_form</field>
        <field name="model">l10n.es.aeat.mod115.report</field>
        <field name="inherit_id" ref="l10n_es_aeat_mod115.view_l10n_es_aeat_mod115_report_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='tax_line_ids']" position="before">
                <group colspan="2">
                    <div class="oe_button_box" style="text-align: left; margin-top: 0.1em">
                        <button type="object" name="show_tax_lines" class="oe_stat_button"
                                icon="fa-list" string="Analizar Líneas" groups="base.group_user"/>
                    </div>
                </group>
            </xpath>
        </field>
    </record>
    <!-- ====================================================================================================  -->

    <!-- ====================================================================================================  -->
    <!-- Modelo 303 - Formulario -->
    <!-- ====================================================================================================  -->
    <record id="motsoft_aeat.mod303_form" model="ir.ui.view">
        <field name="name">motsoft_aeat.mod303_form</field>
        <field name="model">l10n.es.aeat.mod303.report</field>
        <field name="inherit_id" ref="l10n_es_aeat_mod303.view_l10n_es_aeat_mod303_report_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='tax_line_ids']" position="before">
                <group colspan="2">
                    <div class="oe_button_box" style="text-align: left; margin-top: 0.1em">
                        <button type="object" name="show_tax_lines" class="oe_stat_button"
                                icon="fa-list" string="Analizar Líneas" groups="base.group_user"/>
                    </div>
                </group>
            </xpath>
        </field>
    </record>
    <!-- ====================================================================================================  -->

</odoo>
